{"ast":null,"code":"var _jsxFileName = \"/home/udimkpa/Documents/final-project-app-dev/client/src/charts/DonutChart.js\",\n  _s = $RefreshSig$();\nimport axios from 'axios';\nimport React, { useContext } from 'react';\nimport { Chart as ChartJS, ArcElement } from 'chart.js';\nimport 'chart.js/auto';\nimport { SessionContext } from '../contexts/SessionContext';\nimport { BudgetDisplayContext } from '../contexts/BudgetDisplayContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(ArcElement);\nlet myDoughnutChart;\nfunction DoughnutChart() {\n  _s();\n  const {\n    loggedIn,\n    username\n  } = useContext(SessionContext);\n  const {\n    hasBudget,\n    setHasBudget,\n    setDatabase\n  } = useContext(BudgetDisplayContext);\n  const token = window.localStorage.getItem(\"token\");\n  function createChart(data_source) {\n    // if (hasBudget) {\n    var ctx = document.getElementById(\"myChart\").getContext(\"2d\");\n    if (myDoughnutChart) {\n      myDoughnutChart.destroy();\n    }\n    myDoughnutChart = new ChartJS(ctx, {\n      type: 'doughnut',\n      data: data_source\n    });\n    // }\n  }\n  ;\n  function getBudget() {\n    // console.log('Display budget!');\n\n    // const db_name = (loggedIn) ? 'personal-budget' : 'guest-budget';\n    const db_name = loggedIn && token ? 'personal-budget' : 'guest-budget';\n    loggedIn && token ? axios.get('http://localhost:3010/display-user', {\n      headers: {\n        'Authorization': `Bearer ${token}`\n      },\n      database: db_name,\n      username: username\n    }).then(res => {\n      console.log('display-user');\n      if (res.data !== '') {\n        createChart(res.data[0]);\n        setHasBudget(true);\n        setDatabase(db_name);\n      } else {\n        setHasBudget(false);\n      }\n    }).catch(err => {\n      console.log(err);\n    }) : axios.post('http://localhost:3010/display-guest', {\n      database: db_name,\n      username: username\n    }).then(res => {\n      // console.log('display-guest');\n      // console.log(res.data[0]);\n      if (res.data !== '') {\n        createChart(res.data[0]);\n        setDatabase(db_name);\n        setHasBudget(true);\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n  ;\n  getBudget();\n  return hasBudget && /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chart-container\",\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      id: \"myChart\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}\n_s(DoughnutChart, \"vqeIijeZawie4y6GbaRZ7ccYW+k=\");\n_c = DoughnutChart;\nexport default DoughnutChart;\nvar _c;\n$RefreshReg$(_c, \"DoughnutChart\");","map":{"version":3,"names":["axios","React","useContext","Chart","ChartJS","ArcElement","SessionContext","BudgetDisplayContext","jsxDEV","_jsxDEV","register","myDoughnutChart","DoughnutChart","_s","loggedIn","username","hasBudget","setHasBudget","setDatabase","token","window","localStorage","getItem","createChart","data_source","ctx","document","getElementById","getContext","destroy","type","data","getBudget","db_name","get","headers","database","then","res","console","log","catch","err","post","className","children","id","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/udimkpa/Documents/final-project-app-dev/client/src/charts/DonutChart.js"],"sourcesContent":["import axios from 'axios';\nimport React, { useContext } from 'react';\nimport { Chart as ChartJS, ArcElement } from 'chart.js';\nimport 'chart.js/auto'\nimport { SessionContext } from '../contexts/SessionContext';\nimport { BudgetDisplayContext } from '../contexts/BudgetDisplayContext';\n\nChartJS.register(ArcElement);\n\nlet myDoughnutChart;\n\nfunction DoughnutChart() {\n  const { loggedIn, username} = useContext(SessionContext);\n  const { hasBudget, setHasBudget, setDatabase } = useContext(BudgetDisplayContext);\n  const token = window.localStorage.getItem(\"token\");\n  \n  function createChart(data_source) {\n    // if (hasBudget) {\n      var ctx = document.getElementById(\"myChart\").getContext(\"2d\");\n        if (myDoughnutChart) {\n          myDoughnutChart.destroy();\n        }\n        \n        myDoughnutChart = new ChartJS(ctx, {\n        type: 'doughnut',\n        data: data_source,\n      });\n    // }\n  };\n\n  function getBudget() {\n  \t// console.log('Display budget!');\n  \n  \t// const db_name = (loggedIn) ? 'personal-budget' : 'guest-budget';\n  \tconst db_name = (loggedIn && token) ? 'personal-budget' : 'guest-budget';\n\n    (loggedIn && token) ?\n    axios.get('http://localhost:3010/display-user',\n    {\n      headers: {\n      'Authorization': `Bearer ${token}`\n      },\n      database: db_name,\n      username: username\n    })\n    .then((res) => {\n      console.log('display-user');\n      if (res.data !== '') {\n        createChart(res.data[0]);\n        setHasBudget(true);\n        setDatabase(db_name);\n      } else {\n        setHasBudget(false)\n      }\n    })\n    .catch((err) => {\n      console.log(err);\n    })\n    :\n    axios.post('http://localhost:3010/display-guest',\n      {\n        database: db_name,\n        username: username\n      }\n    )\n    .then((res) => {\n      // console.log('display-guest');\n      // console.log(res.data[0]);\n      if (res.data !== '') {\n        createChart(res.data[0]);\n        setDatabase(db_name);\n        setHasBudget(true);\n      }\n    })\n    .catch((err) => {\n      console.log(err);\n    });\n  };\n  \n  getBudget();\n  \n  return (\n    (hasBudget) &&\n    <div className=\"chart-container\">\n        <canvas id=\"myChart\"/>\n    </div>\n  )\n}\n\nexport default DoughnutChart;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}